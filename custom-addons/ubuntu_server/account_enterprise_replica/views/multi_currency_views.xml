<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Hedge Accounting Tree View -->
    <record id="view_hedge_accounting_tree" model="ir.ui.view">
        <field name="name">hedge.accounting.tree</field>
        <field name="model">account.hedge.accounting</field>
        <field name="arch" type="xml">
            <tree string="Hedge Accounting" decoration-success="effectiveness_test=='passed'" decoration-danger="effectiveness_test=='failed'" decoration-warning="effectiveness_test=='partial'">
                <field name="name"/>
                <field name="hedge_type"/>
                <field name="hedged_item"/>
                <field name="hedging_instrument"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="effectiveness_ratio" widget="percentage"/>
                <field name="status"/>
            </tree>
        </field>
    </record>

    <!-- Hedge Accounting Form View -->
    <record id="view_hedge_accounting_form" model="ir.ui.view">
        <field name="name">hedge.accounting.form</field>
        <field name="model">account.hedge.accounting</field>
        <field name="arch" type="xml">
            <form string="Hedge Accounting">
                <header>
                    <button name="test_effectiveness" string="Test Effectiveness" type="object" class="btn-primary"/>
                    <button name="calculate_ineffectiveness" string="Calculate Ineffectiveness" type="object"/>
                    <button name="discontinue_hedge" string="Discontinue" type="object" confirm="Are you sure you want to discontinue this hedge relationship?"/>
                    <field name="status" widget="statusbar" statusbar_visible="draft,designated,effective,discontinued"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <group string="Hedge Designation">
                            <field name="hedge_type"/>
                            <field name="risk_type"/>
                            <field name="designation_date"/>
                            <field name="start_date"/>
                            <field name="end_date"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                        </group>
                        <group string="Effectiveness">
                            <field name="effectiveness_test"/>
                            <field name="effectiveness_ratio" widget="percentage"/>
                            <field name="prospective_test_result"/>
                            <field name="retrospective_test_result"/>
                            <field name="last_test_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Hedged Item">
                            <group>
                                <field name="hedged_item"/>
                                <field name="hedged_item_description"/>
                                <field name="hedged_amount" widget="monetary"/>
                                <field name="hedged_currency_id"/>
                                <field name="hedged_item_maturity"/>
                            </group>
                        </page>
                        <page string="Hedging Instrument">
                            <group>
                                <field name="hedging_instrument"/>
                                <field name="instrument_type"/>
                                <field name="notional_amount" widget="monetary"/>
                                <field name="instrument_currency_id"/>
                                <field name="strike_rate"/>
                                <field name="instrument_maturity"/>
                            </group>
                        </page>
                        <page string="Fair Value">
                            <group col="4">
                                <field name="hedged_item_fair_value" widget="monetary"/>
                                <field name="instrument_fair_value" widget="monetary"/>
                                <field name="fair_value_change_hedged" widget="monetary"/>
                                <field name="fair_value_change_instrument" widget="monetary"/>
                                <field name="ineffective_portion" widget="monetary"/>
                                <field name="effective_portion" widget="monetary"/>
                            </group>
                            <separator string="Fair Value History"/>
                            <field name="fair_value_history" widget="graph" options="{'graph_type': 'line'}"/>
                        </page>
                        <page string="Cash Flow Hedge Reserve" invisible="hedge_type != 'cash_flow'">
                            <group>
                                <field name="cash_flow_hedge_reserve" widget="monetary"/>
                                <field name="amount_reclassified" widget="monetary"/>
                                <field name="expected_reclassification_date"/>
                            </group>
                            <field name="cash_flow_movements">
                                <tree>
                                    <field name="date"/>
                                    <field name="movement_type"/>
                                    <field name="amount" widget="monetary"/>
                                    <field name="description"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Documentation">
                            <group string="Hedge Documentation">
                                <field name="risk_management_objective" widget="html"/>
                                <field name="hedge_strategy" widget="html"/>
                                <field name="effectiveness_assessment_method"/>
                            </group>
                            <separator string="Attachments"/>
                            <field name="attachment_ids" widget="many2many_binary"/>
                        </page>
                        <page string="Accounting Entries">
                            <field name="move_ids" readonly="1">
                                <tree>
                                    <field name="date"/>
                                    <field name="name"/>
                                    <field name="journal_id"/>
                                    <field name="amount_total" widget="monetary"/>
                                    <field name="state"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- FX Revaluation Tree View -->
    <record id="view_fx_revaluation_tree" model="ir.ui.view">
        <field name="name">fx.revaluation.tree</field>
        <field name="model">account.fx.revaluation</field>
        <field name="arch" type="xml">
            <tree string="FX Revaluation">
                <field name="name"/>
                <field name="revaluation_date"/>
                <field name="company_id" groups="base.group_multi_company"/>
                <field name="total_gain" widget="monetary"/>
                <field name="total_loss" widget="monetary"/>
                <field name="net_impact" widget="monetary"/>
                <field name="status"/>
            </tree>
        </field>
    </record>

    <!-- FX Revaluation Form View -->
    <record id="view_fx_revaluation_form" model="ir.ui.view">
        <field name="name">fx.revaluation.form</field>
        <field name="model">account.fx.revaluation</field>
        <field name="arch" type="xml">
            <form string="FX Revaluation">
                <header>
                    <button name="calculate_revaluation" string="Calculate" type="object" class="btn-primary" invisible="status != 'draft'"/>
                    <button name="post_entries" string="Post Entries" type="object" invisible="status != 'calculated'" confirm="This will post revaluation entries. Continue?"/>
                    <button name="reverse_entries" string="Reverse" type="object" invisible="status != 'posted'"/>
                    <field name="status" widget="statusbar" statusbar_visible="draft,calculated,posted"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <group string="Revaluation Parameters">
                            <field name="revaluation_date"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="target_currency_id"/>
                            <field name="journal_id"/>
                            <field name="reversal_date"/>
                        </group>
                        <group string="Results">
                            <field name="total_gain" widget="monetary"/>
                            <field name="total_loss" widget="monetary"/>
                            <field name="net_impact" widget="monetary"/>
                            <field name="entries_count"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Account Balances">
                            <field name="account_revaluation_ids">
                                <tree editable="bottom" decoration-success="unrealized_gain_loss > 0" decoration-danger="unrealized_gain_loss &lt; 0">
                                    <field name="account_id"/>
                                    <field name="currency_id"/>
                                    <field name="balance_currency" widget="monetary"/>
                                    <field name="current_rate"/>
                                    <field name="revaluation_rate"/>
                                    <field name="current_balance" widget="monetary"/>
                                    <field name="revalued_balance" widget="monetary"/>
                                    <field name="unrealized_gain_loss" widget="monetary"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Bank Accounts">
                            <field name="bank_revaluation_ids">
                                <tree>
                                    <field name="journal_id"/>
                                    <field name="currency_id"/>
                                    <field name="balance" widget="monetary"/>
                                    <field name="rate_difference"/>
                                    <field name="adjustment" widget="monetary"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Receivables/Payables">
                            <group string="Partners">
                                <field name="partner_revaluation_ids">
                                    <tree>
                                        <field name="partner_id"/>
                                        <field name="account_type"/>
                                        <field name="currency_id"/>
                                        <field name="original_amount" widget="monetary"/>
                                        <field name="current_balance" widget="monetary"/>
                                        <field name="revalued_amount" widget="monetary"/>
                                        <field name="adjustment" widget="monetary"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page string="Journal Entries">
                            <field name="move_ids" readonly="1">
                                <tree>
                                    <field name="date"/>
                                    <field name="name"/>
                                    <field name="journal_id"/>
                                    <field name="amount_total" widget="monetary"/>
                                    <field name="state"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Exchange Rates">
                            <field name="rate_ids">
                                <tree>
                                    <field name="currency_id"/>
                                    <field name="rate_date"/>
                                    <field name="rate"/>
                                    <field name="source"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- Currency Advanced Management Tree View -->
    <record id="view_currency_advanced_tree" model="ir.ui.view">
        <field name="name">currency.advanced.tree</field>
        <field name="model">account.currency.advanced</field>
        <field name="arch" type="xml">
            <tree string="Currency Management">
                <field name="currency_id"/>
                <field name="company_id" groups="base.group_multi_company"/>
                <field name="rate_type"/>
                <field name="current_rate"/>
                <field name="average_rate"/>
                <field name="closing_rate"/>
                <field name="budget_rate"/>
                <field name="last_update"/>
            </tree>
        </field>
    </record>

    <!-- Currency Advanced Management Form View -->
    <record id="view_currency_advanced_form" model="ir.ui.view">
        <field name="name">currency.advanced.form</field>
        <field name="model">account.currency.advanced</field>
        <field name="arch" type="xml">
            <form string="Advanced Currency Management">
                <header>
                    <button name="update_rates" string="Update Rates" type="object" class="btn-primary"/>
                    <button name="fetch_market_rates" string="Fetch Market Rates" type="object"/>
                    <button name="calculate_volatility" string="Calculate Volatility" type="object"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="currency_id"/>
                        </h1>
                    </div>
                    <group>
                        <group string="Rate Configuration">
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="rate_type"/>
                            <field name="rate_source"/>
                            <field name="auto_update"/>
                            <field name="update_frequency" invisible="auto_update == False"/>
                        </group>
                        <group string="Current Rates">
                            <field name="current_rate"/>
                            <field name="average_rate"/>
                            <field name="closing_rate"/>
                            <field name="budget_rate"/>
                            <field name="last_update"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Rate History">
                            <field name="rate_history_ids">
                                <tree>
                                    <field name="date"/>
                                    <field name="rate"/>
                                    <field name="rate_type"/>
                                    <field name="source"/>
                                    <field name="user_id"/>
                                </tree>
                            </field>
                            <group string="Historical Chart">
                                <field name="rate_chart" widget="graph" options="{'graph_type': 'line'}" nolabel="1"/>
                            </group>
                        </page>
                        <page string="Triangulation">
                            <group string="Triangulation Settings">
                                <field name="enable_triangulation"/>
                                <field name="triangulation_currency_id" invisible="enable_triangulation == False"/>
                                <field name="triangulation_rate" invisible="enable_triangulation == False"/>
                            </group>
                        </page>
                        <page string="Risk Metrics">
                            <group col="4">
                                <field name="volatility_30d" widget="percentage"/>
                                <field name="volatility_90d" widget="percentage"/>
                                <field name="var_95" string="VaR (95%)"/>
                                <field name="var_99" string="VaR (99%)"/>
                                <field name="max_drawdown" widget="percentage"/>
                                <field name="correlation_usd"/>
                            </group>
                            <separator string="Risk Analysis"/>
                            <field name="risk_analysis" widget="html" readonly="1"/>
                        </page>
                        <page string="Exposure">
                            <group string="Currency Exposure">
                                <field name="total_assets" widget="monetary"/>
                                <field name="total_liabilities" widget="monetary"/>
                                <field name="net_exposure" widget="monetary"/>
                                <field name="hedged_amount" widget="monetary"/>
                                <field name="unhedged_exposure" widget="monetary"/>
                            </group>
                            <separator string="Exposure by Account"/>
                            <field name="exposure_by_account">
                                <tree>
                                    <field name="account_id"/>
                                    <field name="debit" widget="monetary"/>
                                    <field name="credit" widget="monetary"/>
                                    <field name="balance" widget="monetary"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Alerts">
                            <field name="alert_ids">
                                <tree editable="bottom">
                                    <field name="alert_type"/>
                                    <field name="threshold"/>
                                    <field name="comparison"/>
                                    <field name="notification_users" widget="many2many_tags"/>
                                    <field name="active"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- FX Revaluation Wizard -->
    <record id="view_fx_revaluation_wizard" model="ir.ui.view">
        <field name="name">fx.revaluation.wizard</field>
        <field name="model">account.fx.revaluation.wizard</field>
        <field name="arch" type="xml">
            <form string="FX Revaluation Wizard">
                <group>
                    <group>
                        <field name="revaluation_date"/>
                        <field name="company_id" groups="base.group_multi_company"/>
                        <field name="journal_id"/>
                    </group>
                    <group>
                        <field name="account_ids" widget="many2many_tags"/>
                        <field name="include_bank_accounts"/>
                        <field name="include_receivables"/>
                        <field name="include_payables"/>
                    </group>
                </group>
                <group string="Options">
                    <field name="auto_reverse"/>
                    <field name="reversal_date" invisible="auto_reverse == False"/>
                    <field name="post_entries"/>
                </group>
                <footer>
                    <button name="run_revaluation" string="Run Revaluation" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Actions -->
    <record id="action_hedge_accounting" model="ir.actions.act_window">
        <field name="name">Hedge Accounting</field>
        <field name="res_model">account.hedge.accounting</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_fx_revaluation" model="ir.actions.act_window">
        <field name="name">FX Revaluation</field>
        <field name="res_model">account.fx.revaluation</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_currency_advanced" model="ir.actions.act_window">
        <field name="name">Currency Management</field>
        <field name="res_model">account.currency.advanced</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_fx_revaluation_wizard" model="ir.actions.act_window">
        <field name="name">FX Revaluation Wizard</field>
        <field name="res_model">account.fx.revaluation.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
</odoo>